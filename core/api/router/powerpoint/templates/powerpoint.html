<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>PowerPoint VBA Runner</title>
<style>
body { font-family: Arial,sans-serif; text-align:center; max-width:900px; margin:auto; background:#fafafa; }
textarea { width:100%; height:120px; font-family: Consolas, monospace; font-size:14px; padding:10px; }
button { padding:10px 20px; margin:10px 5px; cursor:pointer; }
img { max-width:90%; border:1px solid #ccc; border-radius:8px; margin:10px 0; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
a.download-link { display:inline-block; margin-top:15px; padding:10px 15px; background:#4caf50; color:white; text-decoration:none; border-radius:5px; }
a.download-link:hover { background:#45a049; }
</style>
</head>
<body>
{% if not slides %}
<h2>üíª –í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏</h2>
<form method="post">
    <textarea name="user_text" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Å–ª–∞–π–¥–æ–≤..."></textarea><br>
    <button type="submit">‚ñ∂ –°–æ–∑–¥–∞—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é</button>
</form>
{% else %}
<h2>üñº –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞</h2>
<div>
    <img id="slideImage" src="{{ slides[0] }}" alt="–°–ª–∞–π–¥ 1">
    <p id="slideCounter">–°–ª–∞–π–¥ 1 –∏–∑ {{ slides|length }}</p>
</div>
<div>
    <button onclick="prevSlide()">‚¨Ö –ü—Ä–µ–¥—ã–¥—É—â–∏–π</button>
    <button onclick="nextSlide()">–°–ª–µ–¥—É—é—â–∏–π ‚û°</button>
</div>
<a class="download-link" href="{{ download_url }}" target="_blank">üì• –°–∫–∞—á–∞—Ç—å PPTM</a>

<script>
const slides = {{ slides|tojson }};
let current = 0;
const slideImage = document.getElementById('slideImage');
const slideCounter = document.getElementById('slideCounter');

function updateSlide() {
    slideImage.src = slides[current];
    slideCounter.innerText = `–°–ª–∞–π–¥ ${current+1} –∏–∑ ${slides.length}`;
}

function prevSlide() { if(current>0){ current--; updateSlide(); } }
function nextSlide() { if(current<slides.length-1){ current++; updateSlide(); } }
</script>
{% endif %}
</body>
</html>
